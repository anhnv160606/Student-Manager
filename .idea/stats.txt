import json
from collections import Counter

def load_students():
    with open('students.json', 'r', encoding='utf-8') as f:
        return json.load(f)

def average_gpa(students):
    if not students:
        return 0.0
    total_gpa = sum(s['gpa'] for s in students)
    return round(total_gpa / len(students), 2)

def top_students(students, top_n=3):
    return sorted(students, key=lambda s: s['gpa'], reverse=True)[:top_n]

def count_by_major(students):
    majors = [s['major'] for s in students]
    return dict(Counter(majors))

def show_stats():
    students = load_students()

    print("\nğŸ“Š Thá»‘ng kÃª sinh viÃªn:\n")

    avg = average_gpa(students)
    print(f"ğŸ“ GPA trung bÃ¬nh toÃ n há»‡: {avg}\n")

    print("ğŸ… Top 3 sinh viÃªn cÃ³ GPA cao nháº¥t:")
    for idx, s in enumerate(top_students(students), start=1):
        print(f"{idx}. {s['name']} ({s['id']}) - GPA: {s['gpa']}")

    print("\nğŸ“š Sá»‘ lÆ°á»£ng sinh viÃªn theo chuyÃªn ngÃ nh:")
    major_stats = count_by_major(students)
    for major, count in major_stats.items():
        print(f"- {major}: {count} sinh viÃªn")

# Cho phÃ©p cháº¡y riÃªng stats.py Ä‘á»ƒ xem thá»‘ng kÃª
if __name__ == "__main__":
    show_stats()
